<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RGB ì±„ë„ ë¶„ë¦¬ ë° í”½ì…€ ë¶„ì„ê¸°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #000000;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background-color: #ffffff;
            border-radius: 16px;
            padding: 30px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 15px;
            color: #333;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-upload {
            background-color: #4CAF50;
            color: white;
        }

        .btn-upload:hover {
            background-color: #45a049;
        }

        .btn-sample {
            background-color: #2196F3;
            color: white;
        }

        .btn-sample:hover {
            background-color: #0b7dda;
        }

        .btn-reset {
            background-color: #FF5252;
            color: white;
        }

        .btn-reset:hover {
            background-color: #E53935;
        }

        #fileInput {
            display: none;
        }

        .image-grid {
            display: grid;
            grid-template-columns: 1.2fr 1fr;
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto 20px;
            align-items: start;
        }

        .original-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .channels-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
            padding-top: 20px;
        }

        .image-container {
            position: relative;
            background-color: #f5f5f5;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .channel-container {
            position: relative;
            background-color: #f5f5f5;
            border-radius: 12px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            width: 100%;
        }

        .image-label {
            text-align: center;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 18px;
            color: #333;
        }

        .arrow-indicator {
            position: absolute;
            color: #888;
            font-size: 36px;
            font-weight: bold;
        }

        .arrow-to-r {
            top: 20%;
            right: -45px;
        }

        .arrow-to-g {
            top: 50%;
            right: -45px;
            transform: translateY(-50%);
        }

        .arrow-to-b {
            bottom: 20%;
            right: -45px;
        }

        canvas {
            display: block;
            max-width: 100%;
            max-height: 500px;
            height: auto;
            margin: 0 auto;
            cursor: crosshair;
            border-radius: 8px;
        }

        .click-guide {
            text-align: center;
            color: #666;
            font-size: 18px;
            margin-top: 15px;
            font-weight: 500;
        }

        .pixel-info {
            max-width: 1400px;
            margin: 0 auto 30px;
            background-color: #f9f9f9;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .pixel-location {
            font-size: 18px;
            margin-bottom: 10px;
            color: #333;
        }

        .pixel-rgb {
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: #333;
        }

        .color-preview {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            border: 2px solid #555;
            display: inline-block;
        }

        .matrix-guide {
            text-align: center;
            color: #555;
            font-size: 16px;
            margin-bottom: 25px;
            padding: 15px;
            background-color: #f0f8ff;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
        }

        .matrix-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .channel-box {
            background-color: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 2px solid #e0e0e0;
        }

        .channel-box.r-channel {
            border-color: #ffcccb;
        }

        .channel-box.g-channel {
            border-color: #c8e6c9;
        }

        .channel-box.b-channel {
            border-color: #bbdefb;
        }

        .channel-header {
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: 700;
            font-size: 18px;
        }

        .channel-header.r {
            background-color: #8B0000;
            color: white;
        }

        .channel-header.g {
            background-color: #006400;
            color: white;
        }

        .channel-header.b {
            background-color: #00008B;
            color: white;
        }

        .zoom-canvas {
            display: block;
            margin: 0 auto 15px;
            border: 2px solid #555;
            border-radius: 8px;
            image-rendering: pixelated;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 17px;
            font-family: 'Courier New', monospace;
            background-color: #ffffff;
        }

        .matrix-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .r-channel .matrix-table {
            color: #D32F2F;
        }

        .g-channel .matrix-table {
            color: #388E3C;
        }

        .b-channel .matrix-table {
            color: #1976D2;
        }

        .matrix-table td.center {
            background-color: #FFF9C4;
            font-weight: bold;
            border: 2px solid #FBC02D;
        }

        .instruction {
            text-align: center;
            color: #666;
            font-size: 16px;
            margin-top: 20px;
        }

        .selection-box {
            position: absolute;
            border: 3px solid #FFD700;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
    <div class="header">
        <h1>ğŸ¨ RGB ì±„ë„ ë¶„ë¦¬ ë° í”½ì…€ ë¶„ì„ê¸°</h1>
    </div>

    <div class="controls">
        <button class="btn btn-upload" onclick="document.getElementById('fileInput').click()">
            ğŸ“ ì´ë¯¸ì§€ ì—…ë¡œë“œ
        </button>
        <input type="file" id="fileInput" accept="image/*">
        <button class="btn btn-sample" onclick="loadSampleImage()">
            ğŸ–¼ï¸ ìƒ˜í”Œ ì´ë¯¸ì§€ ì‚¬ìš©
        </button>
        <button class="btn btn-reset" onclick="resetApp()">
            ğŸ”„ ì´ˆê¸°í™”
        </button>
    </div>

    <div class="image-grid">
        <div class="original-container">
            <div class="image-container" id="originalContainer">
                <div class="image-label">ì›ë³¸ ì´ë¯¸ì§€</div>
                <canvas id="originalCanvas"></canvas>
                <div class="arrow-indicator arrow-to-r">â†’</div>
                <div class="arrow-indicator arrow-to-g">â†’</div>
                <div class="arrow-indicator arrow-to-b">â†’</div>
            </div>
            <div class="click-guide">ğŸ‘† ì´ë¯¸ì§€ì˜ ì„ì˜ ìœ„ì¹˜ë¥¼ í´ë¦­í•´ë³´ì„¸ìš”</div>
        </div>
        
        <div class="channels-container">
            <div class="channel-container">
                <div class="image-label">R ì±„ë„</div>
                <canvas id="rCanvas"></canvas>
            </div>
            
            <div class="channel-container">
                <div class="image-label">G ì±„ë„</div>
                <canvas id="gCanvas"></canvas>
            </div>
            
            <div class="channel-container">
                <div class="image-label">B ì±„ë„</div>
                <canvas id="bCanvas"></canvas>
            </div>
        </div>
    </div>

    <div class="pixel-info" id="pixelInfo" style="display: none;">
        <div class="pixel-location" id="pixelLocation"></div>
        <div class="pixel-rgb" id="pixelRGB"></div>
    </div>

    <div class="matrix-guide" id="matrixGuide" style="display: none;">
        ğŸ“Š í´ë¦­í•œ ìœ„ì¹˜ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ 5Ã—5 í”½ì…€ ì˜ì—­ì˜ RGB ì±„ë„ë³„ ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    </div>

    <div class="matrix-container" id="matrixContainer" style="display: none;">
        <div class="channel-box r-channel">
            <div class="channel-header r">ğŸ”´ R ì±„ë„</div>
            <canvas class="zoom-canvas" id="rZoom" width="50" height="50"></canvas>
            <table class="matrix-table" id="rMatrix"></table>
        </div>
        
        <div class="channel-box g-channel">
            <div class="channel-header g">ğŸŸ¢ G ì±„ë„</div>
            <canvas class="zoom-canvas" id="gZoom" width="50" height="50"></canvas>
            <table class="matrix-table" id="gMatrix"></table>
        </div>
        
        <div class="channel-box b-channel">
            <div class="channel-header b">ğŸ”µ B ì±„ë„</div>
            <canvas class="zoom-canvas" id="bZoom" width="50" height="50"></canvas>
            <table class="matrix-table" id="bMatrix"></table>
        </div>
    </div>

    <div class="instruction">
        ğŸ’¡ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê±°ë‚˜ ìƒ˜í”Œ ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¨ í›„, ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ì—¬ í”½ì…€ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.
    </div>
    </div>

    <script>
        let originalImage = null;
        let imageData = null;
        let selectionBox = null;

        const originalCanvas = document.getElementById('originalCanvas');
        const rCanvas = document.getElementById('rCanvas');
        const gCanvas = document.getElementById('gCanvas');
        const bCanvas = document.getElementById('bCanvas');

        const originalCtx = originalCanvas.getContext('2d');
        const rCtx = rCanvas.getContext('2d');
        const gCtx = gCanvas.getContext('2d');
        const bCtx = bCanvas.getContext('2d');

        // íŒŒì¼ ì—…ë¡œë“œ
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    loadImage(event.target.result);
                };
                reader.readAsDataURL(file);
            }
        });

        // ìƒ˜í”Œ ì´ë¯¸ì§€ ë¡œë“œ
        function loadSampleImage() {
            const canvas = document.createElement('canvas');
            canvas.width = 400;
            canvas.height = 300;
            const ctx = canvas.getContext('2d');
            
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#FF6B6B');
            gradient.addColorStop(0.5, '#4ECDC4');
            gradient.addColorStop(1, '#45B7D1');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.fillStyle = '#FFE66D';
            ctx.fillRect(50, 50, 100, 100);
            
            ctx.fillStyle = '#A8E6CF';
            ctx.beginPath();
            ctx.arc(300, 150, 60, 0, Math.PI * 2);
            ctx.fill();
            
            loadImage(canvas.toDataURL());
        }

        // ì´ë¯¸ì§€ ë¡œë“œ ë° ì²˜ë¦¬
        function loadImage(src) {
            const img = new Image();
            img.onload = function() {
                originalImage = img;
                
                originalCanvas.width = img.width;
                originalCanvas.height = img.height;
                originalCtx.drawImage(img, 0, 0);
                
                const channelWidth = Math.floor(img.width * 0.5);
                const channelHeight = Math.floor(img.height * 0.5);
                
                rCanvas.width = gCanvas.width = bCanvas.width = channelWidth;
                rCanvas.height = gCanvas.height = bCanvas.height = channelHeight;
                
                imageData = originalCtx.getImageData(0, 0, img.width, img.height);
                
                separateChannels();
                
                const centerX = Math.floor(img.width / 2);
                const centerY = Math.floor(img.height / 2);
                updatePixelInfo(centerX, centerY);
                
                addClickListeners();
            };
            img.src = src;
        }

        // RGB ì±„ë„ ë¶„ë¦¬
        function separateChannels() {
            const data = imageData.data;
            const width = originalCanvas.width;
            const height = originalCanvas.height;
            
            const rData = rCtx.createImageData(rCanvas.width, rCanvas.height);
            const gData = gCtx.createImageData(gCanvas.width, gCanvas.height);
            const bData = bCtx.createImageData(bCanvas.width, bCanvas.height);
            
            for (let y = 0; y < rCanvas.height; y++) {
                for (let x = 0; x < rCanvas.width; x++) {
                    const srcX = Math.floor(x / 0.5);
                    const srcY = Math.floor(y / 0.5);
                    const srcIdx = (srcY * width + srcX) * 4;
                    const destIdx = (y * rCanvas.width + x) * 4;
                    
                    // R ì±„ë„ (Rë§Œ ì¶”ì¶œ, Gì™€ BëŠ” 0)
                    rData.data[destIdx] = data[srcIdx];
                    rData.data[destIdx + 1] = 0;
                    rData.data[destIdx + 2] = 0;
                    rData.data[destIdx + 3] = 255;
                    
                    // G ì±„ë„ (Gë§Œ ì¶”ì¶œ, Rì™€ BëŠ” 0)
                    gData.data[destIdx] = 0;
                    gData.data[destIdx + 1] = data[srcIdx + 1];
                    gData.data[destIdx + 2] = 0;
                    gData.data[destIdx + 3] = 255;
                    
                    // B ì±„ë„ (Bë§Œ ì¶”ì¶œ, Rì™€ GëŠ” 0)
                    bData.data[destIdx] = 0;
                    bData.data[destIdx + 1] = 0;
                    bData.data[destIdx + 2] = data[srcIdx + 2];
                    bData.data[destIdx + 3] = 255;
                }
            }
            
            rCtx.putImageData(rData, 0, 0);
            gCtx.putImageData(gData, 0, 0);
            bCtx.putImageData(bData, 0, 0);
        }

        // í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        function addClickListeners() {
            [originalCanvas, rCanvas, gCanvas, bCanvas].forEach((canvas, idx) => {
                canvas.addEventListener('click', function(e) {
                    const rect = canvas.getBoundingClientRect();
                    const x = Math.floor((e.clientX - rect.left) * (canvas.width / rect.width));
                    const y = Math.floor((e.clientY - rect.top) * (canvas.height / rect.height));
                    
                    let originalX = x;
                    let originalY = y;
                    
                    if (idx > 0) {
                        originalX = Math.floor(x / 0.5);
                        originalY = Math.floor(y / 0.5);
                    }
                    
                    updatePixelInfo(originalX, originalY);
                });
            });
        }

        // ì„ íƒ ì˜ì—­ í‘œì‹œ
        function showSelectionBox(centerX, centerY) {
            // ê¸°ì¡´ ì„ íƒ ë°•ìŠ¤ ì œê±°
            if (selectionBox) {
                selectionBox.remove();
            }
            
            const container = document.getElementById('originalContainer');
            const canvas = originalCanvas;
            const rect = canvas.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();
            
            // 5x5 ì˜ì—­ ê³„ì‚°
            const boxSize = 5;
            const startX = centerX - 2;
            const startY = centerY - 2;
            
            // ìº”ë²„ìŠ¤ ì¢Œí‘œë¥¼ í™”ë©´ ì¢Œí‘œë¡œ ë³€í™˜
            const scaleX = rect.width / canvas.width;
            const scaleY = rect.height / canvas.height;
            
            const boxLeft = startX * scaleX;
            const boxTop = startY * scaleY;
            const boxWidth = boxSize * scaleX;
            const boxHeight = boxSize * scaleY;
            
            // ì„ íƒ ë°•ìŠ¤ ìƒì„±
            selectionBox = document.createElement('div');
            selectionBox.className = 'selection-box';
            selectionBox.style.left = (rect.left - containerRect.left + boxLeft) + 'px';
            selectionBox.style.top = (rect.top - containerRect.top + boxTop) + 'px';
            selectionBox.style.width = boxWidth + 'px';
            selectionBox.style.height = boxHeight + 'px';
            
            container.appendChild(selectionBox);
        }

        // í”½ì…€ ì •ë³´ ì—…ë°ì´íŠ¸
        function updatePixelInfo(x, y) {
            const width = originalCanvas.width;
            const height = originalCanvas.height;
            
            if (x < 0 || x >= width || y < 0 || y >= height) return;
            
            const data = imageData.data;
            const idx = (y * width + x) * 4;
            const r = data[idx];
            const g = data[idx + 1];
            const b = data[idx + 2];
            
            document.getElementById('pixelInfo').style.display = 'block';
            document.getElementById('pixelLocation').innerHTML = 
                `ğŸ“ í´ë¦­í•œ í”½ì…€ ìœ„ì¹˜: (i, j) = (${y}, ${x})`;
            document.getElementById('pixelRGB').innerHTML = 
                `RGB: (${r}, ${g}, ${b}) <span class="color-preview" style="background-color: rgb(${r}, ${g}, ${b});"></span>`;
            
            // ì„ íƒ ì˜ì—­ í‘œì‹œ
            showSelectionBox(x, y);
            
            create5x5Matrix(x, y, r, g, b);
            
            document.getElementById('matrixGuide').style.display = 'block';
            document.getElementById('matrixContainer').style.display = 'grid';
        }

        // 5Ã—5 í–‰ë ¬ ë° í™•ëŒ€ ì´ë¯¸ì§€ ìƒì„±
        function create5x5Matrix(centerX, centerY, centerR, centerG, centerB) {
            const data = imageData.data;
            const width = originalCanvas.width;
            const height = originalCanvas.height;
            
            const rMatrix = [];
            const gMatrix = [];
            const bMatrix = [];
            
            for (let dy = -2; dy <= 2; dy++) {
                const rRow = [];
                const gRow = [];
                const bRow = [];
                
                for (let dx = -2; dx <= 2; dx++) {
                    const px = centerX + dx;
                    const py = centerY + dy;
                    
                    if (px >= 0 && px < width && py >= 0 && py < height) {
                        const idx = (py * width + px) * 4;
                        rRow.push(data[idx]);
                        gRow.push(data[idx + 1]);
                        bRow.push(data[idx + 2]);
                    } else {
                        rRow.push(0);
                        gRow.push(0);
                        bRow.push(0);
                    }
                }
                
                rMatrix.push(rRow);
                gMatrix.push(gRow);
                bMatrix.push(bRow);
            }
            
            createMatrixTable('rMatrix', rMatrix);
            createMatrixTable('gMatrix', gMatrix);
            createMatrixTable('bMatrix', bMatrix);
            
            createZoomCanvas('rZoom', rMatrix);
            createZoomCanvas('gZoom', gMatrix);
            createZoomCanvas('bZoom', bMatrix);
        }

        // í–‰ë ¬ í…Œì´ë¸” ìƒì„±
        function createMatrixTable(elementId, matrix) {
            const table = document.getElementById(elementId);
            table.innerHTML = '';
            
            for (let i = 0; i < 5; i++) {
                const row = table.insertRow();
                for (let j = 0; j < 5; j++) {
                    const cell = row.insertCell();
                    cell.textContent = matrix[i][j];
                    
                    if (i === 2 && j === 2) {
                        cell.className = 'center';
                    }
                }
            }
        }

        // í™•ëŒ€ ìº”ë²„ìŠ¤ ìƒì„± (5Ã—5 â†’ 50Ã—50)
        function createZoomCanvas(canvasId, matrix) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            ctx.imageSmoothingEnabled = false;
            
            const cellSize = 10;
            
            let channelType = 'r';
            if (canvasId === 'gZoom') channelType = 'g';
            else if (canvasId === 'bZoom') channelType = 'b';
            
            for (let i = 0; i < 5; i++) {
                for (let j = 0; j < 5; j++) {
                    const value = matrix[i][j];
                    
                    if (channelType === 'r') {
                        ctx.fillStyle = `rgb(${value}, 0, 0)`;
                    } else if (channelType === 'g') {
                        ctx.fillStyle = `rgb(0, ${value}, 0)`;
                    } else if (channelType === 'b') {
                        ctx.fillStyle = `rgb(0, 0, ${value})`;
                    }
                    
                    ctx.fillRect(j * cellSize, i * cellSize, cellSize, cellSize);
                }
            }
            
            ctx.strokeStyle = '#FFD700';
            ctx.lineWidth = 2;
            ctx.strokeRect(2 * cellSize, 2 * cellSize, cellSize, cellSize);
        }

        // ì´ˆê¸°í™” í•¨ìˆ˜
        function resetApp() {
            originalImage = null;
            imageData = null;
            
            if (selectionBox) {
                selectionBox.remove();
                selectionBox = null;
            }
            
            [originalCanvas, rCanvas, gCanvas, bCanvas].forEach(canvas => {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                canvas.width = 0;
                canvas.height = 0;
            });
            
            document.getElementById('pixelInfo').style.display = 'none';
            document.getElementById('matrixGuide').style.display = 'none';
            document.getElementById('matrixContainer').style.display = 'none';
            
            document.getElementById('fileInput').value = '';
        }
    </script>
</body>
</html>
